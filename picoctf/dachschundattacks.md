# Writeup - Dachshund Attacks
Category: Cryptography, Points: 80


## Descpriton
> What if d is too small? Connect with nc mercury.picoctf.net 30761.


## Vulnerability

If we do `nc mercury.picoctf.net 30761`. We get this

```console
$ nc mercury.picoctf.net 30761
Welcome to my RSA challenge!
e: 34389022232071814955834852459388047831522962882301348055063815673403285933434705636238800181497570459850933008670008329338652699301285249922096990040445004379365350568923044723767665954650857004678351791563610909976730322915541033599922596261308843526931308742599964604982392993612096429440772187206316170717
n: 113044028211207143107744448038066192335580767359584939145263026968202579134800233187862253370293823041847824674173324237883650610678846249743452626922750737055347663224972591870903745428167611478207622606310584048937857487389494804558814248367167586144286747565638839429585074448950277353628871471232064909417
c: 25706492556749757155592077069294837940229848357394926310803142415758936644889144141415861099670399274927089659570626464920578451778027633565291248953613850000494719475563007884652878430038790225749504007563366701692768344594909829030700778566339695255633997872377066285880454423914318060820041207558736365445
```

We can see that the `RSA` encryption is used and we have been given 3 numbers `e`, `n` and `c`. Look at [RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem)).

Now in the question it asks `What if d is too small?`. So if we google, `RSA with small d`. We will get a result to the [Wiener's attack](https://en.wikipedia.org/wiki/Wiener%27s_attack). 

Another way to come to this conclusion is to google `Different names for Dachshund dog`, and one of it's names is `Weiner`. Then your search query can be composed with `RSA, Wiener`.

The Wiener's attack finds the *private key* `d` given the public key `e` and `n` .


## Exploit

If we google search `Wiener's attack python` we will get a repository that automates the Wiener's attack for us. [owiener](https://github.com/orisano/owiener).

The plan:
1. Clone the repo.
2. Remove the `.git` folder - this is because, I had an issue with installing this repo.
3. Within the same folder create a new file.
4. Copy the example script shown in the README to the new file.
5. Replace the values of `e`, `n` and `c` with the given values and get `d`.
6. Decrypt the ciphertext `c` with `d` to get the plaintext integer `m`.
7. Convert `m` integer back to text - this is your flag.

```python
import owiener
import binascii

e = 4057521497576464179917687162671476014930493096140083953528424541504581972059494080655856086548625620122946575196433304242665425974396078697819888685059533833392422801721690519204253869030205799304573554403212939628272428837864939398033643619091481743055199530300276522500800431839844977304921413835304073719
n = 70578168248204933653225796787891403696332784178431027431831784901089854639536469392311126343955051427684122197402594409022159926005334286303404391869506991648965105412227130352813126594176457805943916422602475828592445352717179270627947738986445732702446886560841466407746050102678345330973702779289109096927
d = owiener.attack(e,n)
c = 4221186623412460947102632093656193706604021707950310370489140777045783294061651620393838567524442583328880303583474542855211333169324382321913678804763567751838239125229513910940596348167238853492717483940237246849577251255757161383536593075162746419790155019669212733293796781662134357798423771274590662236

m = pow(c,d,n)
hexm = str(hex(m))[2:]

print(f"d = {d}")
print(f"m = {m}")
print(f"m hex = {hex(m)}")
print(binascii.unhexlify(hexm))
```

You should get the flag.

## References
[Link](https://vivian-dai.github.io/PicoCTF2021-Writeup/Cryptography/Dachshund%20Attacks/dachshundattacks.html)
