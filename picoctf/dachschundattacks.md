# Writeup - Dachshund Attacks
Category: Cryptography, Points: 80


## Descpriton
> What if d is too small? Connect with nc mercury.picoctf.net 30761.


## Vulnerability

If we do `nc mercury.picoctf.net 30761`. We get this

```console
$ nc mercury.picoctf.net 30761
Welcome to my RSA challenge!
e: 80220526204183798821091925928494075577485680407243772426840148176361358762573323497446073576418228458845888522054692555624406450070741957285653772113294360449294766878165926374724225656309611076444463691280023484651520804322246196754495860757560823661784054659713457724139045552229630882015218999249037536721
n: 131186184560217099817586041568160036160318554393458426997316995699635096256140713397999008162646571928995480106475237946911013698050147911845419639576649504764743880388411599782750891193363588318958965054121440322533694324022300558130521696637816774924704391244147828454530156879143134624197610260666230435013
c: 76823527553216309733235554347469705233881837935637524796755068813232671386010063243548313172039335330667736626330056966960595046530725311074474401813742665666786800696902239072291924246256454737098227036791083811615208063649266276396021545177240408814516264596661314157612219879823864228328478822605074714436
```

We can see that the `RSA` encryption is used and we have been given 3 numbers `e`, `n` and `c`. Look at [RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem)).

Now in the question it asks `What if d is too small?`. So if we google, `RSA with small d`. We will get a result to the [Wiener's attack](https://en.wikipedia.org/wiki/Wiener%27s_attack). 

Another way to come to this conclusion is to google `Different names for Dachshund dog`, and one of it's names is `Weiner`. Then your search query can be composed with `RSA, Wiener`.

The Wiener's attack finds the *private key* `d` given the public key `e` and `n` .


## Exploit

If we google search `Wiener's attack python` we will get a repository that automates the Wiener's attack for us. [owiener](https://github.com/orisano/owiener).

The plan:
1. Clone the repo.
2. Remove the `.git` folder - this is because, I had an issue with installing this repo.
3. Within the same folder create a new file.
4. Copy the example script shown in the README to the new file.
5. Replace the values of `e`, `n` and `c` with the given values and get `d`.
6. Decrypt the ciphertext `c` with `d` to get the plaintext integer `m`.
7. Convert `m` integer back to text - this is your flag.

```python
import owiener
import binascii

e = 80220526204183798821091925928494075577485680407243772426840148176361358762573323497446073576418228458845888522054692555624406450070741957285653772113294360449294766878165926374724225656309611076444463691280023484651520804322246196754495860757560823661784054659713457724139045552229630882015218999249037536721
n = 131186184560217099817586041568160036160318554393458426997316995699635096256140713397999008162646571928995480106475237946911013698050147911845419639576649504764743880388411599782750891193363588318958965054121440322533694324022300558130521696637816774924704391244147828454530156879143134624197610260666230435013
c = 76823527553216309733235554347469705233881837935637524796755068813232671386010063243548313172039335330667736626330056966960595046530725311074474401813742665666786800696902239072291924246256454737098227036791083811615208063649266276396021545177240408814516264596661314157612219879823864228328478822605074714436

d = owiener.attack(e, n)

m = pow(c,d,n)
hexm = str(hex(m))[2:]

print(f"d = {d}")
print(f"m = {m}")
print(f"m hex = {hex(m)}")
print(binascii.unhexlify(hexm))
```

You should get the flag.

## References
[Link](https://vivian-dai.github.io/PicoCTF2021-Writeup/Cryptography/Dachshund%20Attacks/dachshundattacks.html)
